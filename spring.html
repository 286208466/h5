<!--
                          @&&$$$$$$$&&@@                          
                   &$$$$$$$$$$$$$$$$$$$$$$$$$&@                   
              @&$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&               
           @$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&@           
         &$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&         
      @&$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&       
     &$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&@       
   @$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&            
  @$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&@         @&$$@  
 @$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&           &$$$$$$$@ 
@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&@           @&$$$$$$$$$$&@
&$$$$$$$$$$$$$@   &$$$$$$$$$$$$$$$$&             &$$$$$$$$$$$$$$$&
&$$$$$$$$$$$$$$@    @&$$$$$$$$&@             @&$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$@      @&$&               &$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$@                    @&$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$&@                &$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
&$$$$$$$$$$$$$$$$$&            @&$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
@$$$$$$$$$$$$$$$$$$&        @$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&&
 &$$$$$$$$$$$$$$$$$$&   @&$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@ 
  &$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@  
   &$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@   
    @$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&     
      @$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@      
        @$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@        
          @&$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&           
            &$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&              
           @$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&                  
           &$$$$$$&    @&&$$$$$$$$$$$$$$&@                        
          @$$$$@            
                                                
                智八哥出品
-->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="format-detection" content="telephone=no" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<title></title>
<link rel="stylesheet" type="text/css" href="./dist/springstyle.css"/>
</head>
<body class="spring-body">

	<!-- <audio preload="" id="bgm" class="bgm hide" loop="loop" autoplay>
       <source src="./src/file/bgm.mp3" type="audio/mpeg">
    </audio>
	<a id="bgAudioBtn" class="on">
		<i></i>
	</a> -->
	
	<div id="preloadWrap">
		<div class="text flex" id="t1">
			<p class="flexitem">请放心</p>
		</div>
		<div class="text flex" id="t2">
			<p class="flexitem">您的手机是正常的</p>
		</div>
		<div class="text flex" id="t3">
			<p class="flexitem">耐心点，还在加载中呢</p>
		</div>
		<div class="text flex" id="t4">
			<p class="flexitem">让我们来看看进度条吧</p>
		</div>
		<div class="text" id="mainView">
			<div id="topScreen">
				<a class="logo">
					<img src="./src/img/spring/logo.png" width="100">
				</a>
			</div>
			<div id="bottomScreen">
				<p>0%</p>
			</div>
			<canvas id="mainCanvas" width="375" height="667"></canvas>
			
			<div id="ticketBtn">
				<div class="circles">
					<div>
					</div>
				</div>
				<a class="btn circleBtn">抢</a>
				
				<div id="goBtn">
					<a data-target="success" class="hide go1">回家</a>
					<a data-target="failure" class="hide go2">继续抢</a>
					<a data-target="failure" class="hide go3">不抢了</a>
				</div>
			
			</div>
			
			
		</div>
	</div>
	
	<div class="scene" id="scene2">
		<video id="video" webkit-playsinline="" playsinline=""></video>
	</div>
	
	<div class="scene" id="scene3">
		<div class="content">
			<h2 class="title">
				<img src="./src/img/spring/scene3title.png" width="100%">
			</h2>
			<div class="info">
				<div class="clearfix">
					<a class="code">
						<img src="./src/img/spring/scene3code.png" width="100%">
					</a>
				</div>
				<a class="btn showInputBtn">生成专属藏头诗</a>
				<div class="btnGroupWrap">
					<div>
						<a class="btn" id="remakeBtn">重新生成</a>
						<a class="btn" id="reinputBtn">我要继续做诗</a>
					</div>
					<p>
						<a id="getImgBtn">生成图片</a>
					</p>
				</div>
				<a class="copyright"></a>
			</div>
			<div id="words">
				<ul></ul>
			</div>
		</div>
		<div id="inputDialog">
			<div class="mask"></div>
			<div>
				<h2 class="logo">
					<img src="./src/img/spring/logo2.png">
				</h2>
				<div class="input">
					<p>智能机器人藏头诗</p>
					<div>
						<input type="text" placeholder="新年大吉大利" maxlength="8">
					</div>
				</div>
				<div class="btnWrap">
					<p>点击此按钮生成属于自己的藏头诗</p>
					<a class="btn" id="makeBtn">生成</a>
				</div>
			</div>
		</div>
	</div>
	
	<div id="previewWrap">
		<div>
			<img src="">
		</div>
	</div>
	
<script type="text/javascript" src="./src/js/jquery.js"></script>	
<script type="text/javascript" src="./src/js/createjs-2015.11.26.min.js"></script>
<script type="text/javascript" src="./src/js/tweenjs/CSSPlugin.js"></script>
<script>

var isPC = function (){
    var userAgentInfo = navigator.userAgent.toLowerCase();
    var Agents = new Array("android", "iphone", "symbianOS", "windows phone", "ipad", "ipod");
    var flag = true;
    for (var v = 0; v < Agents.length; v++) {
        if (userAgentInfo.indexOf(Agents[v]) > 0) { flag = false; break; }
    }
    return flag;
}


var initSnowCanvas = function(id){
	function rnd(n, m){
		return Math.floor(Math.random()*(m-n) + n);
	};

	function d2a(n){
		return n*Math.PI/180;
	};

	//在画布中生成雪花：
	var snowCanvas = document.getElementById(id);
	var ctx = snowCanvas.getContext("2d");
	var maxW = window.innerWidth;
	var maxH = window.innerHeight;
	snowCanvas.width = maxW;
	snowCanvas.height = maxH;
	var arr = [];
	var width = 20; 

	for(var i=0; i<100; i++){
		arr.push({
			"left":rnd(0, 800),
			"top":rnd(0, 600),
			"deg":rnd(-10, 10),
			"scale":rnd(2, 10) 
		});
	}

	setInterval(function(){
		ctx.clearRect(0, 0, snowCanvas.width, snowCanvas.height);
		ctx.save();

		for(var i=0; i<arr.length; i++){
			var h = 0.5 * arr[i].scale;
			arr[i].left = arr[i].left + Math.tan(d2a(arr[i].deg))*h;
			arr[i].top = arr[i].top + h;

			//若已在画面外则删除
			if(arr[i].left < 0 || arr[i].left > maxW || arr[i].top > maxH){
				arr.splice(i--, 1);
				continue;
			}

			var width_i = arr[i].scale;
			var ra = ctx.createRadialGradient(arr[i].left, arr[i].top, width_i/4, arr[i].left, arr[i].top, width_i);
			ra.addColorStop(0, "rgba(255,255,255,1)");
			ra.addColorStop(1, "rgba(255,255,255,0.1)");
			ctx.fillStyle = ra;

			ctx.beginPath();
			ctx.arc(arr[i].left, arr[i].top, width_i, 0, 2*Math.PI);
			ctx.fill();
		}

		ctx.restore();
	}, 50);

	//不断增加新的雪花
	function next(){
		setTimeout(function(){
			if(arr.length < 200){
				for(var i=0; i<20; i++){
					arr.push({
							"left":rnd(0, 800),
							"top":0,
							"deg":rnd(-10, 10),
							"scale":rnd(2, 10) 
							});
				}
			}
			next();
		}, Math.random()*200+500);
	};

	next();
}
</script>
<script type="text/javascript" src="./dist/spring.js"></script>
<!-- 分享 -->
<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js" charset="utf-8"></script>
<script>
var _url = window.location.href;
var _appId = "wxf5ace9dbc2ed5a56";
var _secret = "ada508eeb01215a8c8736ede0b24cbc0";
$.ajax({
	url:"/scsf/core/activity.signature.do",
	type:"post",
	data:{
		"url": _url,
		"appId": _appId,
		"secret": _secret
	},
	success:function(data){
		if(data.status==1){
			_appId=data.appId
			_timestamp=data.timestamp;
			_nonceStr=data.nonceStr;
			_signature=data.signature;
			
			wx.config({
				//debug: true, 
				// 必填，公众号的唯一标识
			    appId: _appId,
			 	// 必填，生成签名的时间戳
			    timestamp: _timestamp,
				// 必填，生成签名的随机串
			    nonceStr: _nonceStr,
			 	// 必填，签名，见附录1
			    signature: _signature,
			 	// 必填，需要使用的JS接口列表，所有JS接口列表见附录2
			    jsApiList: [
					'checkJsApi',
					'onMenuShareTimeline',
					'onMenuShareAppMessage',
					'onMenuShareQQ',
					'onMenuShareWeibo',
					'onMenuShareQZone',
					'hideMenuItems',
					'showMenuItems',
					'hideAllNonBaseMenuItem',
					'showAllNonBaseMenuItem',
					'translateVoice',
					'startRecord',
					'stopRecord',
					'onVoiceRecordEnd',
					'playVoice',
					'onVoicePlayEnd',
					'pauseVoice',
					'stopVoice',
					'uploadVoice',
					'downloadVoice',
					'chooseImage',
					'previewImage',
					'uploadImage',
					'downloadImage',
					'getNetworkType',
					'openLocation',
					'getLocation',
					'hideOptionMenu',
					'showOptionMenu',
					'closeWindow',
					'scanQRCode',
					'chooseWXPay',
					'openProductSpecificView',
					'addCard',
					'chooseCard',
					'openCard'
			    ]
			});
			wx.ready(function(){
				
				var title = "前任？抢票？过年攻略！";
				var link = "./h5/spring.html";
				var desc= "满怀期待地回家，迫不及待地挡枪";
				var imgUrl = "./src/img/spring/wx.jpg";
				
				//监听“分享给朋友”，按钮点击、自定义分享内容及分享结果接口
				wx.onMenuShareAppMessage({
					title: title,
					desc: desc,
					link: link,
					imgUrl: imgUrl,
					success: function (res) {
						shareSuccessCallback();
					},
					cancel: function (res) {
					  
					},
					fail: function (res) {
					  console.log(JSON.stringify(res));
					}
				});
				
				// 监听“分享到朋友圈”按钮点击、自定义分享内容及分享结果接口
				wx.onMenuShareTimeline({
					title: title,
					link: link,
					imgUrl: imgUrl,
					success: function (res) {
						shareSuccessCallback();
					},
					cancel: function (res) {
					
					},
					fail: function (res) {
						//alert(JSON.stringify(res));
					}
				});

				// 监听“分享到QQ”按钮点击、自定义分享内容及分享结果接口
				wx.onMenuShareQQ({
					title: title,
					desc:desc ,
					link: link,
					imgUrl: imgUrl,
					success: function (res) {
						shareSuccessCallback();
					},
					cancel: function (res) {
					
					},
					fail: function (res) {
						//alert(JSON.stringify(res));
					}
				});
				  
				//监听“分享到微博”按钮点击、自定义分享内容及分享结果接口
				wx.onMenuShareWeibo({
					title: title,
					desc: desc,
					link: link,
					imgUrl: imgUrl,
					success: function (res) {
						shareSuccessCallback();
					},
					cancel: function (res) {
					
					},
					fail: function (res) {
						//alert(JSON.stringify(res));
					}
				});

				// 2.5 监听“分享到QZone”按钮点击、自定义分享内容及分享接口
				wx.onMenuShareQZone({
					title: title,
					desc: desc,
					link: link,
					imgUrl: imgUrl,
					success: function (res) {
						shareSuccessCallback();
					},
					cancel: function (res) {
						
					},
					fail: function (res) {
						//alert(JSON.stringify(res));
					}
				});
				
				
			});
			wx.error(function (res) {
				console.log("微信接口调用失败，请稍后...");
			});
		}
			
	},
	error:function(data){
		
	}
});
	
function shareSuccessCallback(){
	
}
</script>
</body>
</html>