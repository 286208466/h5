!function(e){function t(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){function o(){m=new createjs.LoadQueue,m.installPlugin(createjs.Sound),m.on("fileload",a),m.on("progress",i),m.on("complete",r),m.loadFile({id:"video",src:"./src/file/zbg.mp4"});var e=[{id:"scene1",src:"./src/img/spring/scene1.jpg"},{id:"scene1Ticket",src:"./src/img/spring/scene1Ticket.png"},{id:"scene1BgTicket",src:"./src/img/spring/scene1BgTicket.png"},{id:"scene1Btn",src:"./src/img/spring/scene1Btn.png"},{id:"ticketsSuccess",src:"./src/img/spring/ticketsSuccess.png"},{id:"ticketsFailure",src:"./src/img/spring/ticketsFailure.png"},{id:"tickets_failure",src:"./src/img/spring/tickets_failure.png"}];m.loadManifest(e)}function a(e){}function r(){if(h){var e=(new Date).getTime();e-f<2e4?setTimeout(function(){x()},2e4-e+f):x()}else setTimeout(function(){x()},2e3);c()}function i(e){var t=Math.floor(100*e.loaded);$("#progress").text(t+"%")}function c(){y=document.getElementById("mainCanvas"),y.width=2*E,y.height=2*b,$("#mainCanvas").css({width:E,height:b}),w=new createjs.Stage(y),createjs.Touch.enable(w),v=new createjs.Bitmap(m.getResult("scene1"));var e=2*E/750;v.scaleX=v.scaleY=e,w.addChild(v),C=new createjs.Bitmap(m.getResult("scene1Ticket")),T=new createjs.Container,T.width=C.image.width,T.height=C.image.height,T.x=E-C.image.width/2,T.y=244*b/g,C.x=0,C.y=0,T.addChild(C),B=new createjs.Bitmap(m.getResult("scene1BgTicket")),B.x=(T.width-B.image.width)/2,B.y=100,T.addChild(B),w.addChild(T),w.update()}function s(){w.update()}function d(){I=document.getElementById("video"),I.play(),I.onended=function(){$("#scene2").addClass("isHide").removeClass("cur"),$("#scene3").addClass("cur"),u()},I.addEventListener("timeupdate",function(){console.log(this.currentTime),!A&&this.currentTime>24.2&&(this.pause(),A=this.currentTime,$("#tip1").show())})}function u(){var e=["新诗有明月","更有携手留","年来走马蹄","半是出飞流","快意方寸薄","一身无所求","乐游揜不得","心地心不休"],t=L(e);$("#words ul").html(t),l.isWx()}var l=n(1),p=$("html").width(),g=1334;$("html").css({"font-size":p/750*100+"px"});var f,h=2*Math.random()>1;if(isPC())$("body").html("<h2>请使用手机浏览</h2>");else try{!function(e){if(createjs.CSSPlugin.install(createjs.Tween),f=(new Date).getTime(),e){var t=document.getElementById("t1");createjs.Tween.get(t,{loop:!1}).wait(2e3).set({opacity:"1"},t.style).wait(2e3).set({opacity:"0"},t.style).call(function(){var e=document.getElementById("t2");createjs.Tween.get(e,{loop:!1}).wait(2e3).set({opacity:"1"},e.style).wait(2e3).set({opacity:"0"},e.style).call(function(){var e=document.getElementById("t3");createjs.Tween.get(e,{loop:!1}).wait(2e3).set({opacity:"1"},e.style).wait(2e3).set({opacity:"0"},e.style).call(function(){var e=document.getElementById("t4");createjs.Tween.get(e,{loop:!1}).wait(2e3).set({opacity:"1"},e.style).wait(2e3).set({opacity:"0"},e.style).call(function(){var e=document.getElementById("mainView");createjs.Tween.get(e,{loop:!1}).wait(2e3).set({opacity:"1"},e.style).call(function(){$("#mainView").css("z-index","5")})})})})})}else{var n=document.getElementById("mainView");createjs.Tween.get(n,{loop:!1}).wait(1e3).set({opacity:"1"},n.style).call(function(){$("#mainView").css("z-index","5")})}createjs.Ticker.setFPS(10),o()}(h)}catch(e){$("#preloadWrap").addClass("toleft"),$("#scene3").addClass("cur"),u()}var m,y,w,v,C,B,T,j,S,k,x=function(){$("#progress").hide(),$("#mainView").addClass("show");var e=document.getElementById("video");e.poster=m.getItem("scene1").src,e.src=m.getItem("video").src,e.play(),setTimeout(function(){e.pause()},1)},E=window.innerWidth,b=window.innerHeight;$("#ticketBtn .circleBtn").on("touchstart",function(){$("#goBtn").siblings().addClass("hide"),createjs.Ticker.setFPS(8),createjs.Ticker.addEventListener("tick",s),S&&w.removeChild(S),k&&w.removeChild(k);var e=2*Math.random()>1;e?(j=new createjs.SpriteSheet({framerate:9,images:[m.getResult("ticketsSuccess")],frames:{regX:0,height:389.5,count:12,regY:0,width:606},animations:{run:[0,11],startRun:[0]},complete:!0}),S=new createjs.Sprite(j),S.x=E-303,S.y=T.y+280,w.addChild(S),w.update(),S.gotoAndPlay("run")):(k=new createjs.Bitmap(m.getResult("ticketsFailure")),k.x=E-k.image.width/2,k.y=T.y+250,k.alpha=0,createjs.Tween.get(k).to({alpha:1,y:T.y+280},500,createjs.Ease.linear),w.addChild(k),w.update()),e?setTimeout(function(){S.stop(),w.update(),$("#goBtn a[data-target='success']").removeClass("hide"),$("#goBtn a[data-target='failure']").addClass("hide")},1500):($("#goBtn a[data-target='failure']").removeClass("hide"),$("#goBtn a[data-target='success']").addClass("hide"))}),$("#goBtn .go1").on("touchstart",function(){$("#preloadWrap").addClass("hide"),d();var e=document.getElementById("tip2");createjs.Tween.get(e,{loop:!1}).wait(1e3).set({opacity:"1"},e.style).wait(1e3).set({opacity:"0"},e.style).wait(1e3).set({opacity:"1"},e.style).wait(1e3).set({opacity:"0"},e.style).wait(1e3).set({opacity:"1"},e.style).wait(1e3).set({opacity:"0"},e.style)}),$("#goBtn .go2").on("touchstart",function(){$("#goBtn a").addClass("hide"),$("#ticketBtn .circleBtn").trigger("touchstart")}),$("#goBtn .go3").on("touchstart",function(){$("#preloadWrap").addClass("toleft"),$("#scene3").addClass("cur"),u()});var I,A;$("#scene2").on("touchstart",function(){document.getElementById("video").playbackRate=2}),$("#scene2").on("touchend",function(){document.getElementById("video").playbackRate=1});var _,O,M,R,W,P,D=document.getElementById("tip1");D.addEventListener("touchstart",function(e){_=e.targetTouches[0].screenX,O=e.targetTouches[0].screenY,W=!0,P=!0}),D.addEventListener("touchmove",function(e){M=e.targetTouches[0].screenX,R=e.targetTouches[0].screenY,W&&Math.abs(M-_)-Math.abs(R-O)>0&&(e.stopPropagation(),e.preventDefault(),P=!1,M-_<0&&console.log(0))}),D.addEventListener("touchend",function(e){if(M-_<0)if(_-M>120){if(!$("#tip1").is(":hidden")){var t=document.getElementById("video");t.currentTime=A,t.play(),$("#tip1").hide()}}else console.log("2");else console.log("3")});var L=function(e){for(var t="",n=0;n<e.length;n++)if(n%2==0){t+="<li>",t+="<span>";for(var o=0;o<e[n].length;o++)t+="<i>"+e[n][o]+"</i>";t+=",</span>"}else t+="<span>&ensp;"+e[n]+"。</span>",t+="</li>";return t};$(".showInputBtn").on("touchstart",function(){$("#inputDialog input").val(""),$("#inputDialog").addClass("show")}),window.poem="",$("#makeBtn").on("touchstart",function(){var e=$.trim($("#inputDialog input").val());return""==e&&(e="新年大吉大利"),e.length>8?void l.warning("只支持4-8个汉字作诗"):/^[\u4e00-\u9fa5]{4,8}$/i.test(e)?($("#remakeBtn").data("text",e),$("#inputDialog").removeClass("show"),$(".showInputBtn").hide(),$(".btnGroupWrap").show(),l.toast(!0),void $.ajax({url:"./../h5/poem",type:"post",data:{start_words:e},dataTyoe:"json",success:function(e){if(l.toast(!1),0==e.code){if(window.poem=e.poem,e.poem.length>0){var t=L(e.poem);$("#words ul").html(t)}}else 1004==e.code?l.warning("只支持4-8个汉字作诗"):l.warning("抱歉，小八哥走神了，请重新作诗")},error:function(){l.toast(!1),l.warning("抱歉，小八哥走神了，请重新作诗")}})):void l.warning("只支持4-8个汉字作诗")}),$("#remakeBtn").on("touchstart",function(){$("#makeBtn").trigger("touchstart")}),$("#reinputBtn").on("touchstart",function(){$(".showInputBtn").trigger("touchstart")}),$("#getImgBtn").on("click",function(){l.toast(!0),$.ajax({url:"./../h5/sharegen",type:"post",data:{words:JSON.stringify(window.poem)},dataTyoe:"json",success:function(e){l.toast(!1),0==e.code?($("#previewWrap").addClass("show"),$("#previewWrap img").attr("src",e.url)):l.warning(e.msg)},error:function(){l.toast(!1),l.warning("抱歉，小八哥走神了")}})}),$("#previewWrap .closeBtn").on("touchstart",function(){$("#previewWrap").removeClass("show")}),window.app=window.app||{};app.initScene2=function(){document.getElementById("scene2video").play()}},function(e,t,n){!function(){var t=function(){var e=this,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";this.encode=function(n){var o,a,r,i,c,s,d,u="",l=0;for(n=e._utf8_encode(n);l<n.length;)o=n.charCodeAt(l++),a=n.charCodeAt(l++),r=n.charCodeAt(l++),i=o>>2,c=(3&o)<<4|a>>4,s=(15&a)<<2|r>>6,d=63&r,isNaN(a)?s=d=64:isNaN(r)&&(d=64),u=u+t.charAt(i)+t.charAt(c)+t.charAt(s)+t.charAt(d);return u},this.decode=function(n){var o,a,r,i,c,s,d,u="",l=0;for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<n.length;)i=t.indexOf(n.charAt(l++)),c=t.indexOf(n.charAt(l++)),s=t.indexOf(n.charAt(l++)),d=t.indexOf(n.charAt(l++)),o=i<<2|c>>4,a=(15&c)<<4|s>>2,r=(3&s)<<6|d,u+=String.fromCharCode(o),64!=s&&(u+=String.fromCharCode(a)),64!=d&&(u+=String.fromCharCode(r));return u=e._utf8_decode(u)},this._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},this._utf8_decode=function(e){for(var t="",n=0,o=0,a=0,r=0;n<e.length;)o=e.charCodeAt(n),o<128?(t+=String.fromCharCode(o),n++):o>191&&o<224?(a=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&a),n+=2):(a=e.charCodeAt(n+1),r=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&r),n+=3);return t}},n=function(){};n.prototype.getUrlParam=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?decodeURI(n[2]):""},n.prototype.download=function(e){var t=document.getElementById("downloadframe");t?t.src=e:(t=document.createElement("iframe"),t.src=e,t.style.display="none",t.id="downloadframe",document.body.appendChild(t))},n.prototype.getIEVersion=function(){var e,t=navigator.userAgent,n={4:8,5:9,6:10,7:11};return(e=t.match(/MSIE (\d+)/i))&&e[1]?+e[1]:(e=t.match(/Trident\/(\d+)/i),e&&e[1]?n[e[1]]||null:null)},n.prototype.ajax=function(e){var t=e.url,n=e.data||{};"object"==typeof n&&this.getCookie("companyCode")&&(n.companyCode=this.getCookie("companyCode"));var o=e.type?e.type:"post",a=void 0===e.async||e.async,r=e.contentType?e.contentType:"application/x-www-form-urlencoded";$.ajax({url:t,data:n,type:o,dataType:"json",cache:!1,async:a,contentType:r,beforeSend:function(t){e.beforeSend&&e.beforeSend(t)},success:function(t){"function"==typeof e.success&&e.success(t)},error:function(t){"function"==typeof e.error&&e.error(t)},complete:function(){e.complete&&e.complete()}})},n.prototype.filteremoji=function(e){var t=["�[�-�]","�[�-�]","�[�-�]"];return e.replace(new RegExp(t.join("|"),"g"),"")},n.prototype.countByte=function(e){for(var t=0,n=0;n<e.length;n++){var o=e.charCodeAt(n);o>=1&&o<=126||65376<=o&&o<=65439?t++:t+=2}return t},n.prototype.isUrl=function(e){return/(http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:\/~\+#]*[\w\-\@?^=%&\/~\+#])?/.test(e)},n.prototype.escape=function(e){return String(e).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},n.prototype.loadScript=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,t())}:n.onload=function(){t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)},n.prototype.setCookie=function(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var a="; expires="+o.toGMTString();document.cookie=e+"="+t+a+"; path=/"},n.prototype.getCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0,a=n.length;o<a;o++){for(var r=n[o];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null},n.prototype.trim=function(e){return e="string"==typeof e?e:"",e.trim?e.trim():e.replace(/^\s|\s$/g,"")},n.prototype.encrypt=function(e){return(new t).encode(e)},n.prototype.decrypt=function(e){var n=new t,o=n.decode(e);return o=escape(o),o=o.replace(/%00/g,""),o=unescape(o)},n.prototype.warning=function(e){var t=$("#warning"),n=$(document.body);t.length>0&&t.remove();var o='<div id="warning"><div><span>'+e+"</span></div></div>";n.append(o),setTimeout(function(){n.find("#warning").fadeOut()},2500)},n.prototype.toast=function(e){e?(0==$("#toast").length&&$(document.body).append('<div id="toast" style="display: none;"><div class="mask_transparent"></div><div class="toast"><i class="icon-loading"></i><p class="toast_content">数据加载中</p></div></div>'),$("#toast").fadeIn(200)):$("#toast").fadeOut(200)},n.prototype.isWx=function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},n.prototype.extend=function(e){var t=arguments.length;if(t<2||null==e)return e;for(var n=1;n<t;n++)for(var o=arguments[n],a=this.allKeys(o),r=a.length,i=0;i<r;i++){var c=a[i];e[c]=o[c]}return e},n.prototype.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},n.prototype.allKeys=function(e){if(!this.isObject(e))return[];var t=[];for(var n in e)t.push(n);return t},e.exports=new n}()}]);