!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){function o(){m=new createjs.LoadQueue,m.installPlugin(createjs.Sound),m.on("fileload",r),m.on("progress",i),m.on("complete",a),m.loadFile({id:"video",src:"./src/file/zbg.mp4"});var e=[{id:"scene1",src:"./src/img/spring/scene1.jpg"},{id:"scene1Ticket",src:"./src/img/spring/scene1Ticket.png"},{id:"scene1BgTicket",src:"./src/img/spring/scene1BgTicket.png"},{id:"scene1Btn",src:"./src/img/spring/scene1Btn.png"},{id:"ticketsSuccess",src:"./src/img/spring/ticketsSuccess.png"},{id:"ticketsFailure",src:"./src/img/spring/ticketsFailure.png"},{id:"tickets_failure",src:"./src/img/spring/tickets_failure.png"}];m.loadManifest(e)}function r(e){}function a(){if(f){var e=(new Date).getTime();e-h<2e4?setTimeout(function(){$("#mainView").addClass("show")},2e4-e+h):$("#mainView").addClass("show")}else setTimeout(function(){$("#mainView").addClass("show")},2e3);s()}function i(e){$("#bottomScreen p").text(Math.floor(100*e.loaded)+"%")}function s(){y=document.getElementById("mainCanvas"),y.width=2*x,y.height=2*b,$("#mainCanvas").css({width:x,height:b}),w=new createjs.Stage(y),createjs.Touch.enable(w),v=new createjs.Bitmap(m.getResult("scene1"));var e=2*x/750;v.scaleX=v.scaleY=e,w.addChild(v),C=new createjs.Bitmap(m.getResult("scene1Ticket")),j=new createjs.Container,j.width=C.image.width,j.height=C.image.height,j.x=x-C.image.width/2,j.y=244*b/g,C.x=0,C.y=0,j.addChild(C),B=new createjs.Bitmap(m.getResult("scene1BgTicket")),B.x=(j.width-B.image.width)/2,B.y=100,j.addChild(B),w.addChild(j),w.update()}function c(){w.update()}function d(){A=document.getElementById("video"),A.src=m.getItem("video").src,A.play(),A.onended=function(){$("#scene2").addClass("isHide").removeClass("cur"),$("#scene3").addClass("cur"),p()},A.addEventListener("timeupdate",function(){console.log(this.currentTime),this.currentTime>21.4&&this.currentTime<21.6&&(this.pause(),$("#tip1").show())})}function p(){var e=["鞭炮声震除夕夜","万家灯火思语时","瑞狗衔财报新春","金蝉吐运福如海"],t=E(e);if($("#words ul").html(t),u.isWx()){var n=document.getElementById("shareTip");createjs.Tween.get(n,{loop:!1}).wait(1e3).set({opacity:"1"},n.style).wait(1e3).set({opacity:"0"},n.style).wait(1e3).set({opacity:"1"},n.style).wait(1e3).set({opacity:"0"},n.style).wait(1e3).set({opacity:"1"},n.style).wait(1e3).set({opacity:"0"},n.style)}}var u=n(1),l=$("html").width(),g=1334;$("html").css({"font-size":l/750*100+"px"});var h,f=2*Math.random()>1;isPC()?$("body").html("<h2>请使用手机浏览</h2>"):function(e){if(createjs.CSSPlugin.install(createjs.Tween),h=(new Date).getTime(),e){var t=document.getElementById("t1");createjs.Tween.get(t,{loop:!1}).wait(2e3).set({opacity:"1"},t.style).wait(2e3).set({opacity:"0"},t.style);var n=document.getElementById("t2");createjs.Tween.get(n,{loop:!1}).wait(6e3).set({opacity:"1"},n.style).wait(2e3).set({opacity:"0"},n.style);var r=document.getElementById("t3");createjs.Tween.get(r,{loop:!1}).wait(1e4).set({opacity:"1"},r.style).wait(2e3).set({opacity:"0"},r.style);var a=document.getElementById("t4");createjs.Tween.get(a,{loop:!1}).wait(14e3).set({opacity:"1"},a.style).wait(2e3).set({opacity:"0"},a.style);var i=document.getElementById("mainView");createjs.Tween.get(i,{loop:!1}).wait(18e3).set({opacity:"1"},i.style)}else{var i=document.getElementById("mainView");createjs.Tween.get(i,{loop:!1}).wait(1e3).set({opacity:"1"},i.style)}createjs.Ticker.setFPS(10),o()}(f),u.isWx()&&$("#scene3 .content").append('<img src="./src/img/spring/share.png" class="share" id="shareTip">');var m,y,w,v,C,B,j,T,S,k,x=window.innerWidth,b=window.innerHeight;$("#ticketBtn .circleBtn").on("touchstart",function(){$("#goBtn").siblings().addClass("hide"),createjs.Ticker.setFPS(8),createjs.Ticker.addEventListener("tick",c),S&&w.removeChild(S),k&&j.removeChild(k);var e=2*Math.random()>1;e?(T=new createjs.SpriteSheet({framerate:9,images:[m.getResult("ticketsSuccess")],frames:{regX:0,height:389.5,count:12,regY:0,width:606},animations:{run:[0,11],startRun:[0]},complete:!0}),S=new createjs.Sprite(T),S.x=x-303,S.y=j.y+280,w.addChild(S),w.update(),S.gotoAndPlay("run")):(k=new createjs.Bitmap(m.getResult("ticketsFailure")),k.x=(j.width-k.image.width)/2,k.y=200,j.addChild(k),w.update()),e?setTimeout(function(){S.stop(),w.update(),$("#goBtn a[data-target='success']").removeClass("hide"),$("#goBtn a[data-target='failure']").addClass("hide")},1500):($("#goBtn a[data-target='failure']").removeClass("hide"),$("#goBtn a[data-target='success']").addClass("hide"))}),$("#goBtn .go1").on("touchstart",function(){d(),$("#preloadWrap").addClass("hide")}),$("#goBtn .go2").on("touchstart",function(){$("#ticketBtn .circleBtn").trigger("touchstart")}),$("#goBtn .go3").on("touchstart",function(){$("#preloadWrap").addClass("toleft"),$("#scene3").addClass("cur"),p()});var A;$("#scene2 .goHomeWrap").on("touchstart",function(){document.getElementById("video").play(),$("#tip1").hide()});var E=function(e){for(var t="",n=0;n<e.length;n++)if(n%2==0){t+="<li>",t+="<span>";for(var o=0;o<e[n].length;o++)t+="<i>"+e[n][o]+"</i>";t+=",</span>"}else t+="<span>&ensp;"+e[n]+"。</span>",t+="</li>";return t};$(".showInputBtn").on("touchstart",function(){$("#inputDialog input").val(""),$("#inputDialog").addClass("show")}),window.poem="",$("#makeBtn").on("touchstart",function(){var e=$.trim($("#inputDialog input").val());if(""==e&&(e="新年大吉大利"),e.length>8)return void u.warning("不能超过8个字哦");if(!/^[\u4e00-\u9fa5]{1,8}$/i.test(e))return void u.warning("只支持汉字作诗");$("#remakeBtn").data("text",e);var t="http://192.168.32.78:9001/poem?start_words="+e;$("#inputDialog").removeClass("show"),$(".showInputBtn").hide(),$(".btnGroupWrap").show(),u.toast(!0),$.ajax({url:t,type:"get",dataType:"jsonp",success:function(e){if(u.toast(!1),0==e.code){if(window.poem=e.poem,e.poem.length>0){var t=E(e.poem);$("#words ul").html(t)}}else u.warning(e.msg)},error:function(){u.toast(!1)}})}),$("#remakeBtn").on("touchstart",function(){$("#makeBtn").trigger("touchstart")}),$("#reinputBtn").on("touchstart",function(){$(".showInputBtn").trigger("touchstart")}),$("#getImgBtn").on("click",function(){var e=[];for(var t in window.poem)e.push("poem[]="+window.poem[t]);u.toast(!0),$.ajax({url:"http://192.168.32.78:9001/sharegen?"+e.join("&"),type:"get",dataType:"jsonp",success:function(e){u.toast(!1),0==e.code?($("#previewWrap").addClass("show"),$("#previewWrap img").attr("src",e.url)):u.warning(e.msg)},error:function(){u.toast(!1)}})}),$("#previewWrap .closeBtn").on("touchstart",function(){$("#previewWrap").removeClass("show")}),window.app=window.app||{};app.initScene2=function(){document.getElementById("scene2video").play()}},function(e,t,n){!function(){var t=function(){var e=this,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";this.encode=function(n){var o,r,a,i,s,c,d,p="",u=0;for(n=e._utf8_encode(n);u<n.length;)o=n.charCodeAt(u++),r=n.charCodeAt(u++),a=n.charCodeAt(u++),i=o>>2,s=(3&o)<<4|r>>4,c=(15&r)<<2|a>>6,d=63&a,isNaN(r)?c=d=64:isNaN(a)&&(d=64),p=p+t.charAt(i)+t.charAt(s)+t.charAt(c)+t.charAt(d);return p},this.decode=function(n){var o,r,a,i,s,c,d,p="",u=0;for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<n.length;)i=t.indexOf(n.charAt(u++)),s=t.indexOf(n.charAt(u++)),c=t.indexOf(n.charAt(u++)),d=t.indexOf(n.charAt(u++)),o=i<<2|s>>4,r=(15&s)<<4|c>>2,a=(3&c)<<6|d,p+=String.fromCharCode(o),64!=c&&(p+=String.fromCharCode(r)),64!=d&&(p+=String.fromCharCode(a));return p=e._utf8_decode(p)},this._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},this._utf8_decode=function(e){for(var t="",n=0,o=0,r=0,a=0;n<e.length;)o=e.charCodeAt(n),o<128?(t+=String.fromCharCode(o),n++):o>191&&o<224?(r=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&r),n+=2):(r=e.charCodeAt(n+1),a=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&r)<<6|63&a),n+=3);return t}},n=function(){};n.prototype.getUrlParam=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?decodeURI(n[2]):""},n.prototype.download=function(e){var t=document.getElementById("downloadframe");t?t.src=e:(t=document.createElement("iframe"),t.src=e,t.style.display="none",t.id="downloadframe",document.body.appendChild(t))},n.prototype.getIEVersion=function(){var e,t=navigator.userAgent,n={4:8,5:9,6:10,7:11};return(e=t.match(/MSIE (\d+)/i))&&e[1]?+e[1]:(e=t.match(/Trident\/(\d+)/i),e&&e[1]?n[e[1]]||null:null)},n.prototype.ajax=function(e){var t=e.url,n=e.data||{};"object"==typeof n&&this.getCookie("companyCode")&&(n.companyCode=this.getCookie("companyCode"));var o=e.type?e.type:"post",r=void 0===e.async||e.async,a=e.contentType?e.contentType:"application/x-www-form-urlencoded";$.ajax({url:t,data:n,type:o,dataType:"json",cache:!1,async:r,contentType:a,beforeSend:function(t){e.beforeSend&&e.beforeSend(t)},success:function(t){"function"==typeof e.success&&e.success(t)},error:function(t){"function"==typeof e.error&&e.error(t)},complete:function(){e.complete&&e.complete()}})},n.prototype.filteremoji=function(e){var t=["�[�-�]","�[�-�]","�[�-�]"];return e.replace(new RegExp(t.join("|"),"g"),"")},n.prototype.countByte=function(e){for(var t=0,n=0;n<e.length;n++){var o=e.charCodeAt(n);o>=1&&o<=126||65376<=o&&o<=65439?t++:t+=2}return t},n.prototype.isUrl=function(e){return/(http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:\/~\+#]*[\w\-\@?^=%&\/~\+#])?/.test(e)},n.prototype.escape=function(e){return String(e).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},n.prototype.loadScript=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,t())}:n.onload=function(){t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)},n.prototype.setCookie=function(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var r="; expires="+o.toGMTString();document.cookie=e+"="+t+r+"; path=/"},n.prototype.getCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0,r=n.length;o<r;o++){for(var a=n[o];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return null},n.prototype.trim=function(e){return e="string"==typeof e?e:"",e.trim?e.trim():e.replace(/^\s|\s$/g,"")},n.prototype.encrypt=function(e){return(new t).encode(e)},n.prototype.decrypt=function(e){var n=new t,o=n.decode(e);return o=escape(o),o=o.replace(/%00/g,""),o=unescape(o)},n.prototype.warning=function(e){var t=$("#warning"),n=$(document.body);t.length>0&&t.remove();var o='<div id="warning"><div><span>'+e+"</span></div></div>";n.append(o),setTimeout(function(){n.find("#warning").fadeOut()},2500)},n.prototype.toast=function(e){e?(0==$("#toast").length&&$(document.body).append('<div id="toast" style="display: none;"><div class="mask_transparent"></div><div class="toast"><i class="icon-loading"></i><p class="toast_content">数据加载中</p></div></div>'),$("#toast").fadeIn(200)):$("#toast").fadeOut(200)},n.prototype.isWx=function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},n.prototype.extend=function(e){var t=arguments.length;if(t<2||null==e)return e;for(var n=1;n<t;n++)for(var o=arguments[n],r=this.allKeys(o),a=r.length,i=0;i<a;i++){var s=r[i];e[s]=o[s]}return e},n.prototype.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},n.prototype.allKeys=function(e){if(!this.isObject(e))return[];var t=[];for(var n in e)t.push(n);return t},e.exports=new n}()}]);