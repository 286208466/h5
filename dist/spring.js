!function(e){function t(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){function o(){h=new createjs.LoadQueue,h.installPlugin(createjs.Sound),h.on("fileload",a),h.on("progress",r),h.on("complete",i),h.loadFile({id:"video",src:"./src/file/zbg.mp4"});var e=[{id:"scene1",src:"./src/img/spring/scene1.jpg"},{id:"scene1Ticket",src:"./src/img/spring/scene1Ticket.png"},{id:"scene1BgTicket",src:"./src/img/spring/scene1BgTicket.png"},{id:"scene1Btn",src:"./src/img/spring/scene1Btn.png"},{id:"ticketsSuccess",src:"./src/img/spring/ticketsSuccess.png"},{id:"ticketsFailure",src:"./src/img/spring/ticketsFailure.png"},{id:"tickets_failure",src:"./src/img/spring/tickets_failure.png"}];h.loadManifest(e)}function a(e){}function i(){if(f){var e=(new Date).getTime();e-g<2e4?setTimeout(function(){S()},2e4-e+g):S()}else setTimeout(function(){S()},2e3);c()}function r(e){var t=Math.floor(100*e.loaded);$("#progress").text(t+"%")}function c(){w=document.getElementById("mainCanvas"),w.width=2*b,w.height=2*A,$("#mainCanvas").css({width:b,height:A}),y=new createjs.Stage(w),createjs.Touch.enable(y),v=new createjs.Bitmap(h.getResult("scene1"));var e=2*b/750;v.scaleX=v.scaleY=e,y.addChild(v),C=new createjs.Bitmap(h.getResult("scene1Ticket")),k=new createjs.Container,k.width=C.image.width,k.height=C.image.height,k.x=b-C.image.width/2,k.y=244*A/p,C.x=0,C.y=0,k.addChild(C),B=new createjs.Bitmap(h.getResult("scene1BgTicket")),B.x=(k.width-B.image.width)/2,B.y=100,k.addChild(B),y.addChild(k),y.update()}function s(){y.update()}function d(){var e=["新诗有明月","更有携手留","年来走马蹄","半是出飞流","快意方寸薄","一身无所求","乐游揜不得","心地心不休"],t=L(e);$("#words ul").html(t),l.isWx()}var l=n(1),u=$("html").width(),p=1334;$("html").css({"font-size":u/750*100+"px"});var g,f=2*Math.random()>1;if(f=!1,isPC())$("body").html("<h2>请使用手机浏览</h2>");else try{!function(e){if(createjs.CSSPlugin.install(createjs.Tween),g=(new Date).getTime(),e){var t=document.getElementById("t1");createjs.Tween.get(t,{loop:!1}).wait(2e3).set({opacity:"1"},t.style).wait(2e3).set({opacity:"0"},t.style).call(function(){var e=document.getElementById("t2");createjs.Tween.get(e,{loop:!1}).wait(2e3).set({opacity:"1"},e.style).wait(2e3).set({opacity:"0"},e.style).call(function(){var e=document.getElementById("t3");createjs.Tween.get(e,{loop:!1}).wait(2e3).set({opacity:"1"},e.style).wait(2e3).set({opacity:"0"},e.style).call(function(){var e=document.getElementById("t4");createjs.Tween.get(e,{loop:!1}).wait(2e3).set({opacity:"1"},e.style).wait(2e3).set({opacity:"0"},e.style).call(function(){var e=document.getElementById("mainView");createjs.Tween.get(e,{loop:!1}).wait(2e3).set({opacity:"1"},e.style).call(function(){$("#mainView").css("z-index","5")})})})})})}else{var n=document.getElementById("mainView");createjs.Tween.get(n,{loop:!1}).wait(1e3).set({opacity:"1"},n.style).call(function(){$("#mainView").css("z-index","5")})}createjs.Ticker.setFPS(10),o()}(f)}catch(e){$("#preloadWrap").addClass("toleft"),$("#scene3").addClass("cur"),d()}var h,m,w,y,v,C,B,k,x,T,j,S=function(){$("#progress").hide(),$("#mainView").addClass("show");var e=document.getElementById("video");e.src=h.getItem("video").src,e.onended=function(){$("#scene2").addClass("isHide").removeClass("cur"),$("#scene3").addClass("cur"),d()},e.addEventListener("timeupdate",function(){console.log(this.currentTime),!m&&this.currentTime>24.2&&(this.pause(),m=this.currentTime,$("#tip1").show())})},b=window.innerWidth,A=window.innerHeight;$("#ticketBtn .circleBtn").on("click",function(){$("#goBtn").siblings().addClass("hide"),createjs.Ticker.setFPS(8),createjs.Ticker.addEventListener("tick",s),T&&y.removeChild(T),j&&y.removeChild(j);var e=2*Math.random()>1;e?(x=new createjs.SpriteSheet({framerate:9,images:[h.getResult("ticketsSuccess")],frames:{regX:0,height:389.5,count:12,regY:0,width:606},animations:{run:[0,11],endRun:[11]},complete:!0}),T=new createjs.Sprite(x),T.x=b-303,T.y=k.y+280,y.addChild(T),y.update(),T.gotoAndPlay("run")):(j=new createjs.Bitmap(h.getResult("ticketsFailure")),j.x=b-j.image.width/2,j.y=k.y+250,j.alpha=0,createjs.Tween.get(j).to({alpha:1,y:k.y+280},500,createjs.Ease.linear),y.addChild(j),y.update()),e?setTimeout(function(){T.gotoAndPlay("endRun"),y.update(),$("#goBtn a[data-target='success']").removeClass("hide"),$("#goBtn a[data-target='failure']").addClass("hide")},1500):($("#goBtn a[data-target='failure']").removeClass("hide"),$("#goBtn a[data-target='success']").addClass("hide"))}),$("#goBtn .go1").on("click",function(){if(document.getElementById("video").play(),setTimeout(function(){$("#preloadWrap").addClass("hide")},500),R.versions.iPhone){var e=document.getElementById("tip2");createjs.Tween.get(e,{loop:!1}).wait(1e3).set({opacity:"1"},e.style).wait(1e3).set({opacity:"0"},e.style).wait(1e3).set({opacity:"1"},e.style).wait(1e3).set({opacity:"0"},e.style).wait(1e3).set({opacity:"1"},e.style).wait(1e3).set({opacity:"0"},e.style)}}),$("#goBtn .go2").on("click",function(){$("#goBtn a").addClass("hide"),$("#ticketBtn .circleBtn").trigger("click")}),$("#goBtn .go3").on("click",function(){$("#preloadWrap").addClass("toleft"),$("#scene3").addClass("cur"),d()}),$("#video").on("touchstart",function(e){e.preventDefault(),e.stopPropagation(),document.getElementById("video").playbackRate=2}),$("#video").on("touchend",function(e){e.preventDefault(),e.stopPropagation(),document.getElementById("video").playbackRate=1});var E,I,O,P,_,M,W=document.getElementById("tip1");W.addEventListener("touchstart",function(e){E=e.targetTouches[0].screenX,I=e.targetTouches[0].screenY,_=!0,M=!0}),W.addEventListener("touchmove",function(e){O=e.targetTouches[0].screenX,P=e.targetTouches[0].screenY,_&&Math.abs(O-E)-Math.abs(P-I)>0&&(e.stopPropagation(),e.preventDefault(),M=!1,O-E<0&&console.log(0))}),W.addEventListener("touchend",function(e){if(O-E<0)if(E-O>120){if(!$("#tip1").is(":hidden")){var t=document.getElementById("video");t.play(),$("#tip1").hide()}}else console.log("2");else console.log("3")});var R={versions:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:-1==e.indexOf("Safari"),weixin:e.indexOf("MicroMessenger")>-1,qq:" qq"==e.match(/\sQQ/i)}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},L=function(e){for(var t="",n=0;n<e.length;n++)if(n%2==0){t+="<li>",t+="<span>";for(var o=0;o<e[n].length;o++)t+="<i>"+e[n][o]+"</i>";t+=",</span>"}else{t+="<span>&ensp;";for(var o=0;o<e[n].length;o++)t+="<i>"+e[n][o]+"</i>";t+="。</span>",t+="</li>"}return t};$(".showInputBtn").on("click",function(){$("#inputDialog").addClass("show"),$("#inputDialog input").val("")}),window.poem="",$("#makeBtn").on("click",function(){var e=$.trim($("#inputDialog input").val());return""==e&&(e="新年大吉大利"),e.length>8?void l.warning("只支持2-8个简体中文作诗"):/^[\u4e00-\u9fa5]{2,8}$/i.test(e)?($("#remakeBtn").data("text",e),$("#inputDialog").removeClass("show"),$(".showInputBtn").hide(),$(".btnGroupWrap").show(),l.toast(!0),void $.ajax({url:"./../h5/poem",type:"post",data:{start_words:e},dataTyoe:"json",success:function(t){if(0==t.code){if(l.toast(!1),window.poem=t.poem,t.poem.length>0){var n=L(t.poem);$("#words ul").html(n)}}else window.poem="",$("#words ul").html(""),D(e)},error:function(){window.poem="",$("#words ul").html(""),D(e)}})):void l.warning("只支持2-8个简体中文作诗")});var D=function(e){$.ajax({url:"./../h5/poem",type:"post",data:{start_words:e},dataTyoe:"json",success:function(e){if(l.toast(!1),0==e.code){if(window.poem=e.poem,e.poem.length>0){var t=L(e.poem);$("#words ul").html(t)}}else 1004==e.code?l.warning("只支持2-8个简体中文作诗"):1005==e.code?l.warning("抱歉，小八哥作不来诗"):l.warning("抱歉，小八哥走神了，请重新作诗")},error:function(){l.toast(!1),l.warning("抱歉，小八哥走神了，请重新作诗")}})};$("#remakeBtn").on("click",function(){""==window.poem?$(".showInputBtn").trigger("click"):$("#makeBtn").trigger("click")}),$("#reinputBtn").on("click",function(){$(".showInputBtn").trigger("click")}),$("#getImgBtn").on("click",function(){l.toast(!0),$.ajax({url:"./../h5/sharegen",type:"post",data:{words:JSON.stringify(window.poem)},dataTyoe:"json",success:function(e){0==e.code?(l.toast(!1),$("#previewWrap").addClass("show"),$("#previewWrap img").attr("src",e.url)):V(window.poem)},error:function(){V(window.poem)}})});var V=function(e){$.ajax({url:"./../h5/sharegen",type:"post",data:{words:e},dataTyoe:"json",success:function(e){l.toast(!1),0==e.code?($("#previewWrap").addClass("show"),$("#previewWrap img").attr("src",e.url)):l.warning("诶，网络不佳，请重新生成")},error:function(){l.toast(!1),l.warning("诶，网络不佳，请重新生成")}})};$("#previewWrap .closeBtn").on("click",function(){$("#previewWrap").removeClass("show")}),window.app=window.app||{};app.initScene2=function(){}},function(e,t,n){!function(){var t=function(){var e=this,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";this.encode=function(n){var o,a,i,r,c,s,d,l="",u=0;for(n=e._utf8_encode(n);u<n.length;)o=n.charCodeAt(u++),a=n.charCodeAt(u++),i=n.charCodeAt(u++),r=o>>2,c=(3&o)<<4|a>>4,s=(15&a)<<2|i>>6,d=63&i,isNaN(a)?s=d=64:isNaN(i)&&(d=64),l=l+t.charAt(r)+t.charAt(c)+t.charAt(s)+t.charAt(d);return l},this.decode=function(n){var o,a,i,r,c,s,d,l="",u=0;for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<n.length;)r=t.indexOf(n.charAt(u++)),c=t.indexOf(n.charAt(u++)),s=t.indexOf(n.charAt(u++)),d=t.indexOf(n.charAt(u++)),o=r<<2|c>>4,a=(15&c)<<4|s>>2,i=(3&s)<<6|d,l+=String.fromCharCode(o),64!=s&&(l+=String.fromCharCode(a)),64!=d&&(l+=String.fromCharCode(i));return l=e._utf8_decode(l)},this._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},this._utf8_decode=function(e){for(var t="",n=0,o=0,a=0,i=0;n<e.length;)o=e.charCodeAt(n),o<128?(t+=String.fromCharCode(o),n++):o>191&&o<224?(a=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&a),n+=2):(a=e.charCodeAt(n+1),i=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&i),n+=3);return t}},n=function(){};n.prototype.getUrlParam=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?decodeURI(n[2]):""},n.prototype.download=function(e){var t=document.getElementById("downloadframe");t?t.src=e:(t=document.createElement("iframe"),t.src=e,t.style.display="none",t.id="downloadframe",document.body.appendChild(t))},n.prototype.getIEVersion=function(){var e,t=navigator.userAgent,n={4:8,5:9,6:10,7:11};return(e=t.match(/MSIE (\d+)/i))&&e[1]?+e[1]:(e=t.match(/Trident\/(\d+)/i),e&&e[1]?n[e[1]]||null:null)},n.prototype.ajax=function(e){var t=e.url,n=e.data||{};"object"==typeof n&&this.getCookie("companyCode")&&(n.companyCode=this.getCookie("companyCode"));var o=e.type?e.type:"post",a=void 0===e.async||e.async,i=e.contentType?e.contentType:"application/x-www-form-urlencoded";$.ajax({url:t,data:n,type:o,dataType:"json",cache:!1,async:a,contentType:i,beforeSend:function(t){e.beforeSend&&e.beforeSend(t)},success:function(t){"function"==typeof e.success&&e.success(t)},error:function(t){"function"==typeof e.error&&e.error(t)},complete:function(){e.complete&&e.complete()}})},n.prototype.filteremoji=function(e){var t=["�[�-�]","�[�-�]","�[�-�]"];return e.replace(new RegExp(t.join("|"),"g"),"")},n.prototype.countByte=function(e){for(var t=0,n=0;n<e.length;n++){var o=e.charCodeAt(n);o>=1&&o<=126||65376<=o&&o<=65439?t++:t+=2}return t},n.prototype.isUrl=function(e){return/(http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:\/~\+#]*[\w\-\@?^=%&\/~\+#])?/.test(e)},n.prototype.escape=function(e){return String(e).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},n.prototype.loadScript=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,t())}:n.onload=function(){t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)},n.prototype.setCookie=function(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var a="; expires="+o.toGMTString();document.cookie=e+"="+t+a+"; path=/"},n.prototype.getCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0,a=n.length;o<a;o++){for(var i=n[o];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null},n.prototype.trim=function(e){return e="string"==typeof e?e:"",e.trim?e.trim():e.replace(/^\s|\s$/g,"")},n.prototype.encrypt=function(e){return(new t).encode(e)},n.prototype.decrypt=function(e){var n=new t,o=n.decode(e);return o=escape(o),o=o.replace(/%00/g,""),o=unescape(o)},n.prototype.warning=function(e){var t=$("#warning"),n=$(document.body);t.length>0&&t.remove();var o='<div id="warning"><div><span>'+e+"</span></div></div>";n.append(o),setTimeout(function(){n.find("#warning").fadeOut()},2500)},n.prototype.toast=function(e){e?(0==$("#toast").length&&$(document.body).append('<div id="toast" style="display: none;"><div class="mask_transparent"></div><div class="toast"><i class="icon-loading"></i><p class="toast_content">数据加载中</p></div></div>'),$("#toast").fadeIn(200)):$("#toast").fadeOut(200)},n.prototype.isWx=function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},n.prototype.extend=function(e){var t=arguments.length;if(t<2||null==e)return e;for(var n=1;n<t;n++)for(var o=arguments[n],a=this.allKeys(o),i=a.length,r=0;r<i;r++){var c=a[r];e[c]=o[c]}return e},n.prototype.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},n.prototype.allKeys=function(e){if(!this.isObject(e))return[];var t=[];for(var n in e)t.push(n);return t},e.exports=new n}()}]);